{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\umarm\\\\OneDrive\\\\Desktop\\\\fiverr-clone\\\\fontend\\\\src\\\\components\\\\ChatApp.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Messaging from \"./Messaging\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:5000\");\nfunction ChatApp() {\n  _s();\n  const [users, setUsers] = useState([]); // To store the list of users\n  const [selectedUser, setSelectedUser] = useState(null); // To store the selected user\n  const [conversations, setConversations] = useState([]);\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [userId, setUserId] = useState(\"\");\n\n  // Fetch logged-in user's ID and list of all users\n  useEffect(() => {\n    const loggedInUser = localStorage.getItem(\"userId\");\n    if (loggedInUser) {\n      setUserId(loggedInUser);\n\n      // Fetch all users\n      axios.get(\"http://localhost:5000/api/users\").then(res => setUsers(res.data)).catch(err => console.error(\"Error fetching users:\", err));\n\n      // Fetch conversations for the logged-in user\n      axios.get(`http://localhost:5000/api/conversations/${loggedInUser}`).then(res => setConversations(res.data)).catch(err => console.error(\"Error fetching conversations:\", err));\n    }\n  }, []);\n\n  // Handle user selection to start a conversation\n  const handleUserSelect = receiverId => {\n    console.log(`Making GET request to: http://localhost:5000/api/conversations/${userId}/${receiverId}`);\n    axios.get(`http://localhost:5000/api/conversations/${userId}/${receiverId}`).then(res => {\n      if (res.data) {\n        setSelectedConversation(res.data);\n        socket.emit(\"joinConversation\", res.data._id);\n      }\n    }).catch(err => {\n      console.error(\"Error checking conversation:\", err.response ? err.response.data : err.message);\n\n      // Create new conversation if not found\n      axios.post('http://localhost:5000/api/conversations', {\n        participants: [userId, receiverId],\n        messages: []\n      }).then(newConversation => {\n        console.log(\"New conversation created:\", newConversation.data);\n        setSelectedConversation(newConversation.data);\n        socket.emit(\"joinConversation\", newConversation.data._id);\n      }).catch(err => {\n        console.error(\"Error creating new conversation:\", err);\n      });\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        borderRight: \"1px solid #ddd\",\n        padding: \"10px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Select a User to Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: users.filter(user => user._id !== userId) // Exclude the logged-in user\n        .map(user => /*#__PURE__*/_jsxDEV(\"li\", {\n          onClick: () => handleUserSelect(user._id) // Start a conversation with selected user\n          ,\n          style: {\n            cursor: \"pointer\",\n            padding: \"5px\"\n          },\n          children: user.name\n        }, user._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 2,\n        padding: \"10px\"\n      },\n      children: selectedConversation ? /*#__PURE__*/_jsxDEV(Messaging, {\n        conversationId: selectedConversation._id,\n        receiverId: selectedConversation.participants.find(id => id !== userId),\n        socket: socket\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Select a user to start a conversation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatApp, \"3CU0f5NQulHx/1eRgulbE3gbKro=\");\n_c = ChatApp;\nexport default ChatApp;\nvar _c;\n$RefreshReg$(_c, \"ChatApp\");","map":{"version":3,"names":["React","useState","useEffect","axios","Messaging","io","jsxDEV","_jsxDEV","socket","ChatApp","_s","users","setUsers","selectedUser","setSelectedUser","conversations","setConversations","selectedConversation","setSelectedConversation","userId","setUserId","loggedInUser","localStorage","getItem","get","then","res","data","catch","err","console","error","handleUserSelect","receiverId","log","emit","_id","response","message","post","participants","messages","newConversation","style","display","children","flex","borderRight","padding","fileName","_jsxFileName","lineNumber","columnNumber","filter","user","map","onClick","cursor","name","conversationId","find","id","_c","$RefreshReg$"],"sources":["C:/Users/umarm/OneDrive/Desktop/fiverr-clone/fontend/src/components/ChatApp.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport Messaging from \"./Messaging\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst socket = io(\"http://localhost:5000\");\r\n\r\nfunction ChatApp() {\r\n  const [users, setUsers] = useState([]); // To store the list of users\r\n  const [selectedUser, setSelectedUser] = useState(null); // To store the selected user\r\n  const [conversations, setConversations] = useState([]);\r\n  const [selectedConversation, setSelectedConversation] = useState(null);\r\n  const [userId, setUserId] = useState(\"\");\r\n\r\n  // Fetch logged-in user's ID and list of all users\r\n  useEffect(() => {\r\n    const loggedInUser = localStorage.getItem(\"userId\");\r\n    if (loggedInUser) {\r\n      setUserId(loggedInUser);\r\n\r\n      // Fetch all users\r\n      axios\r\n        .get(\"http://localhost:5000/api/users\")\r\n        .then((res) => setUsers(res.data))\r\n        .catch((err) => console.error(\"Error fetching users:\", err));\r\n\r\n      // Fetch conversations for the logged-in user\r\n      axios\r\n        .get(`http://localhost:5000/api/conversations/${loggedInUser}`)\r\n        .then((res) => setConversations(res.data))\r\n        .catch((err) => console.error(\"Error fetching conversations:\", err));\r\n    }\r\n  }, []);\r\n\r\n  // Handle user selection to start a conversation\r\n  const handleUserSelect = (receiverId) => {\r\n    console.log(`Making GET request to: http://localhost:5000/api/conversations/${userId}/${receiverId}`);\r\n  \r\n    axios\r\n      .get(`http://localhost:5000/api/conversations/${userId}/${receiverId}`)\r\n      .then((res) => {\r\n        if (res.data) {\r\n          setSelectedConversation(res.data);\r\n          socket.emit(\"joinConversation\", res.data._id);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error checking conversation:\", err.response ? err.response.data : err.message);\r\n        \r\n        // Create new conversation if not found\r\n        axios.post('http://localhost:5000/api/conversations', {\r\n          participants: [userId, receiverId],\r\n          messages: []\r\n        })\r\n        .then((newConversation) => {\r\n          console.log(\"New conversation created:\", newConversation.data);\r\n          setSelectedConversation(newConversation.data);\r\n          socket.emit(\"joinConversation\", newConversation.data._id);\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"Error creating new conversation:\", err);\r\n        });\r\n      });\r\n  };\r\n  \r\n  return (\r\n    <div style={{ display: \"flex\" }}>\r\n      {/* User List */}\r\n      <div style={{ flex: 1, borderRight: \"1px solid #ddd\", padding: \"10px\" }}>\r\n        <h3>Select a User to Chat</h3>\r\n        <ul>\r\n          {users\r\n            .filter((user) => user._id !== userId) // Exclude the logged-in user\r\n            .map((user) => (\r\n              <li\r\n                key={user._id}\r\n                onClick={() => handleUserSelect(user._id)} // Start a conversation with selected user\r\n                style={{ cursor: \"pointer\", padding: \"5px\" }}\r\n              >\r\n                {user.name}\r\n              </li>\r\n            ))}\r\n        </ul>\r\n      </div>\r\n\r\n      {/* Messaging Area */}\r\n      <div style={{ flex: 2, padding: \"10px\" }}>\r\n        {selectedConversation ? (\r\n          <Messaging\r\n            conversationId={selectedConversation._id}\r\n            receiverId={selectedConversation.participants.find(\r\n              (id) => id !== userId\r\n            )}\r\n            socket={socket}\r\n          />\r\n        ) : (\r\n          <p>Select a user to start a conversation</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatApp;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}